!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("@ngneat/error-tailor",["exports","@angular/core","@angular/forms","rxjs","rxjs/operators","@angular/common"],t):t(((r=r||self).ngneat=r.ngneat||{},r.ngneat["error-tailor"]={}),r.ng.core,r.ng.forms,r.rxjs,r.rxjs.operators,r.ng.common)}(this,(function(r,t,o,e,n,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var s=function(){return(s=Object.assign||function(r){for(var t,o=1,e=arguments.length;o<e;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}).apply(this,arguments)};function c(r,t,o,e){var n,i=arguments.length,s=i<3?t:null===e?e=Object.getOwnPropertyDescriptor(t,o):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,t,o,e);else for(var c=r.length-1;c>=0;c--)(n=r[c])&&(s=(i<3?n(s):i>3?n(t,o,s):n(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s}function l(r,t){return function(o,e){t(o,e,r)}}function a(r,t){var o="function"==typeof Symbol&&r[Symbol.iterator];if(!o)return r;var e,n,i=o.call(r),s=[];try{for(;(void 0===t||t-- >0)&&!(e=i.next()).done;)s.push(e.value)}catch(r){n={error:r}}finally{try{e&&!e.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return s}var p=function(){function r(r,t){this.cdr=r,this.host=t,this.errorText=null,this.hideError=!0}return r.prototype.createTemplate=function(r,t,o){this.errorTemplate=r,this.errorContext={$implicit:t,text:o},this.cdr.markForCheck()},Object.defineProperty(r.prototype,"customClass",{set:function(r){this.host.nativeElement.classList.add(r)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"text",{set:function(r){r!==this.errorText&&(this.errorText=r,this.hideError=!r,this.cdr.markForCheck())},enumerable:!0,configurable:!0}),r.ctorParameters=function(){return[{type:t.ChangeDetectorRef},{type:t.ElementRef}]},r=c([t.Component({selector:"control-error",template:'\n    <label class="control-error" [class.hide-control]="hideError" *ngIf="!errorTemplate">{{ errorText }}</label>\n    <ng-template *ngTemplateOutlet="errorTemplate; context: errorContext"></ng-template>\n  ',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:["\n      .hide-control {\n        display: none !important;\n      }\n\n      :host {\n        display: block;\n      }\n    "]})],r)}(),h=function(){function r(r){this.vcr=r}return r.ctorParameters=function(){return[{type:t.ViewContainerRef}]},r=c([t.Directive({selector:"[controlErrorAnchor]",exportAs:"controlErrorAnchor"})],r)}(),u=new t.InjectionToken("FORM_ERRORS",{providedIn:"root",factory:function(){return{}}}),f=new t.InjectionToken("ErrorTailorConfigProvider"),m=function(){function r(r){var t=this;this.host=r,this.submit$=e.fromEvent(this.element,"submit").pipe(n.tap((function(){!1===t.element.classList.contains("form-submitted")&&t.element.classList.add("form-submitted")})),n.shareReplay({refCount:!0,bufferSize:1})),this.reset$=e.fromEvent(this.element,"reset").pipe(n.tap((function(){t.element.classList.remove("form-submitted")})),n.shareReplay({refCount:!0,bufferSize:1}))}return Object.defineProperty(r.prototype,"element",{get:function(){return this.host.nativeElement},enumerable:!0,configurable:!0}),r.ctorParameters=function(){return[{type:t.ElementRef}]},r=c([t.Directive({selector:"form[errorTailor]"})],r)}(),y=function(){function r(r,t,o,n,i,s,c,l,a){this.vcr=r,this.resolver=t,this.host=o,this.config=n,this.globalErrors=i,this.controlErrorAnchorParent=s,this.form=c,this.ngControl=l,this.controlContainer=a,this.customErrors={},this.controlErrorsOnAsync=!0,this.controlErrorsOnBlur=!0,this.destroy=new e.Subject,this.mergedConfig={},this.submit$=this.form?this.form.submit$:e.EMPTY,this.reset$=this.form?this.form.reset$:e.EMPTY,this.mergedConfig=this.buildConfig()}return r.prototype.ngOnInit=function(){var r=this;this.anchor=this.resolveAnchor(),this.control=(this.controlContainer||this.ngControl).control;var t=!!this.control.asyncValidator,o=this.mergedConfig.blurPredicate(this.host.nativeElement),i=this.control.statusChanges.pipe(n.distinctUntilChanged()),s=this.control.valueChanges,c=e.merge(i,s),l=e.EMPTY,a=e.EMPTY;(this.controlErrorsOnAsync&&t&&(l=i.pipe(n.startWith(!0))),this.controlErrorsOnBlur&&o)&&(a=e.fromEvent(this.host.nativeElement,"focusout").pipe(n.switchMap((function(){return s.pipe(n.startWith(!0))}))));var p=e.merge(this.submit$.pipe(n.mapTo(!0)),this.reset$.pipe(n.mapTo(!1))).pipe(n.switchMap((function(r){return r?c.pipe(n.startWith(!0)):e.NEVER})));this.reset$.pipe(n.takeUntil(this.destroy)).subscribe((function(){return r.clearRefs()})),e.merge(l,a,p).pipe(n.takeUntil(this.destroy)).subscribe((function(){return r.valueChanges()}))},r.prototype.setError=function(r,t){if(!this.ref){var o=this.resolver.resolveComponentFactory(this.mergedConfig.controlErrorComponent);this.ref=this.anchor.createComponent(o)}var e=this.ref.instance;this.controlErrorsTpl?e.createTemplate(this.controlErrorsTpl,t,r):e.text=r,this.controlErrorsClass&&(e.customClass=this.controlErrorsClass),this.mergedConfig.controlErrorComponentAnchorFn&&(this.customAnchorDestroyFn=this.mergedConfig.controlErrorComponentAnchorFn(this.host.nativeElement,this.ref.hostView.rootNodes[0]))},r.prototype.ngOnDestroy=function(){this.destroy.next(),this.clearRefs()},r.prototype.clearRefs=function(){this.customAnchorDestroyFn&&(this.customAnchorDestroyFn(),this.customAnchorDestroyFn=null),this.ref&&this.ref.destroy(),this.ref=null},r.prototype.valueChanges=function(){var r=this.control.errors;if(r){var t=a(Object.keys(r),1)[0],o=this.customErrors[t]||this.globalErrors[t];if(!o)return;var e="function"==typeof o?o(r[t]):o;this.setError(e,r)}else this.ref&&this.setError(null)},r.prototype.resolveAnchor=function(){return this.controlErrorAnchor?this.controlErrorAnchor.vcr:this.controlErrorAnchorParent?this.controlErrorAnchorParent.vcr:this.vcr},r.prototype.buildConfig=function(){return s({blurPredicate:function(r){return"INPUT"===r.tagName||"SELECT"===r.tagName},controlErrorComponent:p},this.config)},r.ctorParameters=function(){return[{type:t.ViewContainerRef},{type:t.ComponentFactoryResolver},{type:t.ElementRef},{type:void 0,decorators:[{type:t.Inject,args:[f]}]},{type:void 0,decorators:[{type:t.Inject,args:[u]}]},{type:h,decorators:[{type:t.Optional}]},{type:m,decorators:[{type:t.Optional}]},{type:o.NgControl,decorators:[{type:t.Optional},{type:t.Self}]},{type:o.ControlContainer,decorators:[{type:t.Optional},{type:t.Self}]}]},c([t.Input("controlErrors")],r.prototype,"customErrors",void 0),c([t.Input()],r.prototype,"controlErrorsClass",void 0),c([t.Input()],r.prototype,"controlErrorsTpl",void 0),c([t.Input()],r.prototype,"controlErrorsOnAsync",void 0),c([t.Input()],r.prototype,"controlErrorsOnBlur",void 0),c([t.Input()],r.prototype,"controlErrorAnchor",void 0),r=c([t.Directive({selector:"[formControlName]:not([controlErrorsIgnore]), [formControl]:not([controlErrorsIgnore]), [formGroup]:not([controlErrorsIgnore]), [formGroupName]:not([controlErrorsIgnore]), [formArrayName]:not([controlErrorsIgnore]), [ngModel]:not([controlErrorsIgnore])"}),l(3,t.Inject(f)),l(4,t.Inject(u)),l(5,t.Optional()),l(6,t.Optional()),l(7,t.Optional()),l(7,t.Self()),l(8,t.Optional()),l(8,t.Self())],r)}(),d=[p,h,y,m],g=function(){function r(){}var o;return o=r,r.forRoot=function(r){return void 0===r&&(r={}),{ngModule:o,providers:[{provide:f,useValue:r},s({provide:u},r.errors)]}},r=o=c([t.NgModule({declarations:[y,h,p,m],imports:[i.CommonModule],exports:[d],entryComponents:[p]})],r)}();r.ControlErrorAnchorDirective=h,r.ControlErrorsDirective=y,r.DefaultControlErrorComponent=p,r.ErrorTailorConfigProvider=f,r.ErrorTailorModule=g,r.FORM_ERRORS=u,r.FormActionDirective=m,Object.defineProperty(r,"__esModule",{value:!0})}));
//# sourceMappingURL=ngneat-error-tailor.umd.min.js.map