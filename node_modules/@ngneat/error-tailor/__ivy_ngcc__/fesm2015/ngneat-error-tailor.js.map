{"version":3,"file":"ngneat-error-tailor.js","sources":["@ngneat/error-tailor/lib/control-error.component.ts","@ngneat/error-tailor/lib/control-error-anchor.directive.ts","@ngneat/error-tailor/lib/providers.ts","@ngneat/error-tailor/lib/form-action.directive.ts","@ngneat/error-tailor/lib/control-error.directive.ts","@ngneat/error-tailor/lib/error-tailor.module.ts","@ngneat/error-tailor/public-api.ts","@ngneat/error-tailor/ngneat-error-tailor.ts"],"names":[],"mappings":"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","sourcesContent":["import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, TemplateRef } from '@angular/core';\nimport { ValidationErrors } from '@angular/forms';\n\nexport type ErrorComponentTemplate = TemplateRef<{ $implicit: ValidationErrors; text: string }>;\n\nexport interface ControlErrorComponent {\n  customClass: string;\n  text: string | null;\n  createTemplate?(tpl: ErrorComponentTemplate, error: ValidationErrors, text: string): void;\n}\n\n@Component({\n  selector: 'control-error',\n  template: `\n    <label class=\"control-error\" [class.hide-control]=\"hideError\" *ngIf=\"!errorTemplate\">{{ errorText }}</label>\n    <ng-template *ngTemplateOutlet=\"errorTemplate; context: errorContext\"></ng-template>\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  styles: [\n    `\n      .hide-control {\n        display: none !important;\n      }\n\n      :host {\n        display: block;\n      }\n    `\n  ]\n})\nexport class DefaultControlErrorComponent implements ControlErrorComponent {\n  errorText: string | null = null;\n  errorTemplate: ErrorComponentTemplate | undefined;\n  errorContext: { $implicit: ValidationErrors; text: string };\n  hideError = true;\n\n  createTemplate(tpl: ErrorComponentTemplate, error: ValidationErrors, text: string) {\n    this.errorTemplate = tpl;\n    this.errorContext = { $implicit: error, text };\n    this.cdr.markForCheck();\n  }\n\n  set customClass(className: string) {\n    this.host.nativeElement.classList.add(className);\n  }\n\n  set text(value: string | null) {\n    if (value !== this.errorText) {\n      this.errorText = value;\n      this.hideError = !value;\n      this.cdr.markForCheck();\n    }\n  }\n\n  constructor(private cdr: ChangeDetectorRef, private host: ElementRef<HTMLElement>) {}\n}\n","import { Directive, ViewContainerRef } from '@angular/core';\n\n@Directive({\n  selector: '[controlErrorAnchor]',\n  exportAs: 'controlErrorAnchor'\n})\nexport class ControlErrorAnchorDirective {\n  constructor(public vcr: ViewContainerRef) {}\n}\n","import { InjectionToken, ValueSansProvider, FactorySansProvider, Type } from '@angular/core';\nimport { ErrorsMap } from './types';\nimport { ControlErrorComponent } from './control-error.component';\n\nexport const FORM_ERRORS = new InjectionToken('FORM_ERRORS', {\n  providedIn: 'root',\n  factory: () => {\n    return {};\n  }\n});\n\nexport interface ErrorsUseValue extends ValueSansProvider {\n  useValue: ErrorsMap;\n}\n\nexport interface ErrorsUseFactory extends FactorySansProvider {\n  useFactory: (...args: any[]) => ErrorsMap;\n}\n\nexport type ErrorsProvider = ErrorsUseValue | ErrorsUseFactory;\n\nexport type ErrorTailorConfig = {\n  errors?: ErrorsProvider;\n  blurPredicate?: (element: Element) => boolean;\n  controlErrorComponent?: Type<ControlErrorComponent>;\n  controlErrorComponentAnchorFn?: (hostElement: Element, errorElement: Element) => () => void;\n};\n\nexport const ErrorTailorConfigProvider = new InjectionToken<ErrorTailorConfig>('ErrorTailorConfigProvider');\n","import { Directive, ElementRef } from '@angular/core';\nimport { fromEvent, Observable } from 'rxjs';\nimport { shareReplay, tap } from 'rxjs/operators';\n\n@Directive({\n  selector: 'form[errorTailor]'\n})\nexport class FormActionDirective {\n  submit$: Observable<Event> = fromEvent(this.element, 'submit').pipe(\n    tap(() => {\n      if (this.element.classList.contains('form-submitted') === false) {\n        this.element.classList.add('form-submitted');\n      }\n    }),\n    shareReplay({ refCount: true, bufferSize: 1 })\n  );\n\n  reset$: Observable<Event> = fromEvent(this.element, 'reset').pipe(\n    tap(() => {\n      this.element.classList.remove('form-submitted');\n    }),\n    shareReplay({ refCount: true, bufferSize: 1 })\n  );\n\n  constructor(private host: ElementRef<HTMLFormElement>) {}\n\n  get element() {\n    return this.host.nativeElement;\n  }\n}\n","import {\n  ComponentFactoryResolver,\n  ComponentRef,\n  Directive,\n  ElementRef,\n  Inject,\n  Input,\n  OnDestroy,\n  OnInit,\n  Optional,\n  Self,\n  TemplateRef,\n  ViewContainerRef,\n  EmbeddedViewRef\n} from '@angular/core';\nimport { AbstractControl, ControlContainer, NgControl, ValidationErrors } from '@angular/forms';\nimport { DefaultControlErrorComponent, ControlErrorComponent } from './control-error.component';\nimport { ControlErrorAnchorDirective } from './control-error-anchor.directive';\nimport { EMPTY, fromEvent, merge, NEVER, Observable, Subject } from 'rxjs';\nimport { ErrorTailorConfig, ErrorTailorConfigProvider, FORM_ERRORS } from './providers';\nimport { distinctUntilChanged, mapTo, startWith, switchMap, takeUntil, tap } from 'rxjs/operators';\nimport { FormActionDirective } from './form-action.directive';\nimport { ErrorsMap } from './types';\n\n@Directive({\n  selector:\n    '[formControlName]:not([controlErrorsIgnore]), [formControl]:not([controlErrorsIgnore]), [formGroup]:not([controlErrorsIgnore]), [formGroupName]:not([controlErrorsIgnore]), [formArrayName]:not([controlErrorsIgnore]), [ngModel]:not([controlErrorsIgnore])'\n})\nexport class ControlErrorsDirective implements OnInit, OnDestroy {\n  @Input('controlErrors') customErrors: ErrorsMap = {};\n  @Input() controlErrorsClass: string | undefined;\n  @Input() controlErrorsTpl: TemplateRef<any> | undefined;\n  @Input() controlErrorsOnAsync = true;\n  @Input() controlErrorsOnBlur = true;\n  @Input() controlErrorAnchor: ControlErrorAnchorDirective;\n\n  private ref: ComponentRef<ControlErrorComponent>;\n  private anchor: ViewContainerRef;\n  private submit$: Observable<Event>;\n  private reset$: Observable<Event>;\n  private control: AbstractControl;\n  private destroy = new Subject();\n  private mergedConfig: ErrorTailorConfig = {};\n  private customAnchorDestroyFn: () => void;\n\n  constructor(\n    private vcr: ViewContainerRef,\n    private resolver: ComponentFactoryResolver,\n    private host: ElementRef,\n    @Inject(ErrorTailorConfigProvider) private config: ErrorTailorConfig,\n    @Inject(FORM_ERRORS) private globalErrors,\n    @Optional() private controlErrorAnchorParent: ControlErrorAnchorDirective,\n    @Optional() private form: FormActionDirective,\n    @Optional() @Self() private ngControl: NgControl,\n    @Optional() @Self() private controlContainer: ControlContainer\n  ) {\n    this.submit$ = this.form ? this.form.submit$ : EMPTY;\n    this.reset$ = this.form ? this.form.reset$ : EMPTY;\n    this.mergedConfig = this.buildConfig();\n  }\n\n  ngOnInit() {\n    this.anchor = this.resolveAnchor();\n    this.control = (this.controlContainer || this.ngControl).control;\n    const hasAsyncValidator = !!this.control.asyncValidator;\n    const isInput = this.mergedConfig.blurPredicate(this.host.nativeElement);\n\n    const statusChanges$ = this.control.statusChanges.pipe(distinctUntilChanged());\n    const valueChanges$ = this.control.valueChanges;\n    const controlChanges$ = merge(statusChanges$, valueChanges$);\n    let changesOnAsync$: Observable<any> = EMPTY;\n    let changesOnBlur$: Observable<any> = EMPTY;\n\n    if (this.controlErrorsOnAsync && hasAsyncValidator) {\n      // hasAsyncThenUponStatusChange\n      changesOnAsync$ = statusChanges$.pipe(startWith(true));\n    }\n\n    if (this.controlErrorsOnBlur && isInput) {\n      const blur$ = fromEvent(this.host.nativeElement, 'focusout');\n      // blurFirstThenUponChange\n      changesOnBlur$ = blur$.pipe(switchMap(() => valueChanges$.pipe(startWith(true))));\n    }\n\n    const submit$ = merge(this.submit$.pipe(mapTo(true)), this.reset$.pipe(mapTo(false)));\n\n    // when submitted, submitFirstThenUponChanges\n    const changesOnSubmit$ = submit$.pipe(\n      switchMap(submit => (submit ? controlChanges$.pipe(startWith(true)) : NEVER))\n    );\n\n    // on reset, clear ComponentRef and customAnchorDestroyFn\n    this.reset$.pipe(takeUntil(this.destroy)).subscribe(() => this.clearRefs());\n\n    merge(changesOnAsync$, changesOnBlur$, changesOnSubmit$)\n      .pipe(takeUntil(this.destroy))\n      .subscribe(() => this.valueChanges());\n  }\n\n  private setError(text: string, error?: ValidationErrors) {\n    if (!this.ref) {\n      const factory = this.resolver.resolveComponentFactory<ControlErrorComponent>(\n        this.mergedConfig.controlErrorComponent\n      );\n      this.ref = this.anchor.createComponent<ControlErrorComponent>(factory);\n    }\n    const instance = this.ref.instance;\n\n    if (this.controlErrorsTpl) {\n      instance.createTemplate(this.controlErrorsTpl, error, text);\n    } else {\n      instance.text = text;\n    }\n\n    if (this.controlErrorsClass) {\n      instance.customClass = this.controlErrorsClass;\n    }\n\n    if (this.mergedConfig.controlErrorComponentAnchorFn) {\n      this.customAnchorDestroyFn = this.mergedConfig.controlErrorComponentAnchorFn(\n        this.host.nativeElement as HTMLElement,\n        (this.ref.hostView as EmbeddedViewRef<any>).rootNodes[0] as HTMLElement\n      );\n    }\n  }\n\n  ngOnDestroy() {\n    this.destroy.next();\n    this.clearRefs();\n  }\n\n  private clearRefs(): void {\n    if (this.customAnchorDestroyFn) {\n      this.customAnchorDestroyFn();\n      this.customAnchorDestroyFn = null;\n    }\n    if (this.ref) {\n      this.ref.destroy();\n    }\n    this.ref = null;\n  }\n\n  private valueChanges() {\n    const controlErrors = this.control.errors;\n    if (controlErrors) {\n      const [firstKey] = Object.keys(controlErrors);\n      const getError = this.customErrors[firstKey] || this.globalErrors[firstKey];\n      if (!getError) {\n        return;\n      }\n\n      const text = typeof getError === 'function' ? getError(controlErrors[firstKey]) : getError;\n      this.setError(text, controlErrors);\n    } else if (this.ref) {\n      this.setError(null);\n    }\n  }\n\n  private resolveAnchor() {\n    if (this.controlErrorAnchor) {\n      return this.controlErrorAnchor.vcr;\n    }\n\n    if (this.controlErrorAnchorParent) {\n      return this.controlErrorAnchorParent.vcr;\n    }\n    return this.vcr;\n  }\n\n  private buildConfig(): ErrorTailorConfig {\n    return {\n      ...{\n        blurPredicate(element) {\n          return element.tagName === 'INPUT' || element.tagName === 'SELECT';\n        },\n        controlErrorComponent: DefaultControlErrorComponent\n      },\n      ...this.config\n    };\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { ControlErrorsDirective } from './control-error.directive';\nimport { ControlErrorAnchorDirective } from './control-error-anchor.directive';\nimport { DefaultControlErrorComponent } from './control-error.component';\nimport { CommonModule } from '@angular/common';\nimport { FormActionDirective } from './form-action.directive';\nimport { ErrorTailorConfig, ErrorTailorConfigProvider, FORM_ERRORS } from './providers';\n\nconst api = [DefaultControlErrorComponent, ControlErrorAnchorDirective, ControlErrorsDirective, FormActionDirective];\n\n@NgModule({\n  declarations: [\n    ControlErrorsDirective,\n    ControlErrorAnchorDirective,\n    DefaultControlErrorComponent,\n    FormActionDirective\n  ],\n  imports: [CommonModule],\n  exports: [api],\n  entryComponents: [DefaultControlErrorComponent]\n})\nexport class ErrorTailorModule {\n  static forRoot(config: ErrorTailorConfig = {}): ModuleWithProviders {\n    return {\n      ngModule: ErrorTailorModule,\n      providers: [\n        {\n          provide: ErrorTailorConfigProvider,\n          useValue: config\n        },\n        {\n          provide: FORM_ERRORS,\n          ...config.errors\n        } as any\n      ]\n    };\n  }\n}\n","/*\n * Public API Surface of error-tailor\n */\n\nexport * from './lib/error-tailor.module';\nexport * from './lib/control-error.component';\nexport * from './lib/control-error-anchor.directive';\nexport * from './lib/control-error.directive';\nexport * from './lib/form-action.directive';\nexport * from './lib/providers';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]}